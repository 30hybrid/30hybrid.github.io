import{_ as R}from"./SortByDropdown.vue.1a8ff7fb.js";import{_ as B}from"./TitleList.vue.0c5e30b4.js";import{d as E,u as P,V as q,n as f,a as L,m as V,c as C,W as j,g as k,h as x,i as y,w as H,j as l,X as M,p as N}from"./entry.7726ca09.js";import{u as O}from"./useArchiveIcon.18656aa1.js";function w(c){let o,s=c[0],i=1;for(;i<c.length;){const t=c[i],r=c[i+1];if(i+=2,(t==="optionalAccess"||t==="optionalCall")&&s==null)return;t==="access"||t==="optionalAccess"?(o=s,s=r(s)):(t==="call"||t==="optionalCall")&&(s=r((...p)=>s.call(o,...p)),o=void 0)}return s}const T={class:"flex min-h-full w-full flex-col"},X=E({__name:"ArchiveList",props:{slug:{}},setup(c){const o=c,s=P(),i=q(),t=f(!0),r=L(),{infiniteScrolling:p}=V(),S=C(()=>w([[...s.categories,...s.genres],"access",e=>e.find,"call",e=>e(n=>n.slug===o.slug),"optionalAccess",e=>e.name])),m=f(),v=f(),d=C(()=>r.query.sortBy||"relevant"),h=r.query.stream==="true",g=f({}),_=f(d.value);async function A(e,n){n!==_.value&&(g.value={},_.value=n),t.value=!0;const a=await M("ARCHIVE::"+[o.slug].join(",")+e+n+h,()=>N.API.actions.archive([o.slug],h,e,n));m.value=a,t.value=!1,a&&(w([m,"access",u=>u.value,"optionalAccess",u=>u.error])&&i(m.value.msg,"ERROR"),g.value[e]=a.result.posts,v.value={pages:a.result.pages,page:a.result.page,total:a.result.total})}return j(()=>{const e=Number(r.query.page||"1");A(e,d.value)}),(e,n)=>{const a=R,u=B;return k(),x("div",T,[y(u,{"secondary-title-type":"",transparent:"",class:"min-h-full",title:l(S)||"",icon:("useArchiveIcon"in e?e.useArchiveIcon:l(O))(e.slug),"is-loading":l(t),data:l(g),"result-info":l(v),onPageChanged:n[0]||(n[0]=I=>l(p)&&A(I,l(d)))},{header:H(()=>[y(a)]),_:1},8,["title","icon","is-loading","data","result-info"])])}}});export{X as _};
