import{_ as B}from"./SortByDropdown.vue.5c55c1fb.js";import{_ as I}from"./TitleList.vue.e3afd2b1.js";import{d as S,R as E,B as P,r as f,S as q,l as C,ab as H,o as L,e as b,h as y,w as k,g as i,K as x,H as M}from"./entry.bed34153.js";import{u as N}from"./useArchiveIcon.18656aa1.js";function w(l){let o,s=l[0],c=1;for(;c<l.length;){const t=l[c],r=l[c+1];if(c+=2,(t==="optionalAccess"||t==="optionalCall")&&s==null)return;t==="access"||t==="optionalAccess"?(o=s,s=r(s)):(t==="call"||t==="optionalCall")&&(s=r((...p)=>s.call(o,...p)),o=void 0)}return s}const O={class:"flex min-h-full w-full flex-col"},D=S({__name:"ArchiveList",props:{slug:{}},setup(l){const o=l,s=E(),c=P(),t=f(!0),r=q(),p=C(()=>w([[...s.categories,...s.genres],"access",e=>e.find,"call",e=>e(a=>a.slug===o.slug),"optionalAccess",e=>e.name])),d=f(),g=f(),m=C(()=>r.query.sortBy||"relevant"),h=r.query.stream==="true",v=f({}),_=f(m.value);async function A(e,a){a!==_.value&&(v.value={},_.value=a),t.value=!0;const n=await x("ARCHIVE::"+[o.slug].join(",")+e+a+h,()=>M.API.actions.archive([o.slug],h,e,a));d.value=n,t.value=!1,n&&(w([d,"access",u=>u.value,"optionalAccess",u=>u.error])&&c(d.value.msg,"ERROR"),v.value[e]=n.result.posts,g.value={pages:n.result.pages,page:n.result.page,total:n.result.total})}return H(()=>{const e=Number(r.query.page||"1");A(e,m.value)}),(e,a)=>{const n=B,u=I;return L(),b("div",O,[y(u,{"secondary-title-type":"",transparent:"",class:"min-h-full",title:i(p)||"",icon:("useArchiveIcon"in e?e.useArchiveIcon:i(N))(e.slug),"is-loading":i(t),data:i(v),"result-info":i(g),onPageChanged:a[0]||(a[0]=R=>A(R,i(m)))},{header:k(()=>[y(n)]),_:1},8,["title","icon","is-loading","data","result-info"])])}}});export{D as _};
