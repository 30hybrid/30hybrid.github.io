import{d as Q,b as Y,l as F,r as A,o as b,e as P,f as u,h as L,g as S,K as W,L as G,t as B,E as ve,O as H,V as le,W as se,m as ee,q,a2 as ie,a3 as re,B as te,Z as j,s as X,w as Z,v as V,F as ue,T as oe,a4 as be,n as ae,a5 as ge,G as J,H as ye,U as me,C as ce,a6 as he,y as _e,a7 as xe,p as we,R as ke,z as Se,a8 as Te,c as Pe,J as $e,Y as Ee,a9 as Ce,I as Le,aa as Ie}from"./entry.95f381ee.js";import{_ as De}from"./nuxt-link.b23469bb.js";import{v as z,r as Ae,f as Be,n as Oe,s as Fe,q as Ne,e as Re,a as qe,o as je}from"./welcome.vue.1c65ae5a.js";import{_ as He}from"./FormDropdown.vue.a40525a3.js";import{u as fe}from"./useBackground.145b7faf.js";/* empty css                       *//* empty css                           */import"./FormInput.637f8e2e.js";/* empty css                               */import"./splide-extension-grid.esm.3d826a4c.js";/* empty css                        *//* empty css                             */import"./SidebarMain.vue.f7d3a02d.js";/* empty css                              *//* empty css                                  *//* empty css                    */const de=l=>(le("data-v-4ce07527"),l=l(),se(),l),Ve={id:"episode-section",class:"local-numbers my-12 flex min-h-full w-full cursor-default flex-col overflow-visible rounded-xl pb-32"},Me={class:"relative z-10 -mb-20 flex w-full justify-end"},Ue={class:"flex w-full flex-col flex-nowrap gap-12 overflow-y-auto px-2"},ze={class:"items- relative flex w-full flex-col flex-nowrap overflow-visible p-4"},We={class:"relative mx-4 flex items-center"},Ge={class:"text-fonts-50 whitespace-nowrap rounded-xl rounded-b-none p-2 px-4 text-3xl font-semibold"},Qe={class:"text-fonts-50 relative flex text-3xl font-bold"},Ke=de(()=>u("span",{class:"bg-bg-1 absolute top-1/3 h-3 w-3 rounded-full blur-lg ltr:left-1/2 rtl:right-1/2"},null,-1)),Xe={class:"flex flex-row flex-wrap items-center gap-8 px-8 !text-base"},Ze=["onClick"],Ye=de(()=>u("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 0H0V30H8L8 8.34204L8 0ZM8 8.34204L7.99611 8.34485L7.99914 8.34212L7.99914 4C7.99914 6.92963 6.92984 8.96704 6.14398 9.93857C6.02543 10.063 5.91246 10.1875 5.80492 10.312C5.78418 10.3319 5.76392 10.3507 5.74418 10.3684L5.7979 10.3201C2.85283 13.7386 3.99163 17.1976 5.90023 19.4823L5.74423 19.3421C6.49593 20.0176 7.99914 22.2948 7.99914 25.9999L7.99914 21.3683L7.99706 21.3665L8 21.3684L8 8.34204Z"},null,-1)),Je=[Ye],et=de(()=>u("span",{class:"bg-primary-500 shadow-primary-500 absolute top-1/2 h-[60%] w-[2px] -translate-y-1/2 rounded-full opacity-100 shadow-[0_0_8px_1px] ltr:left-1 rtl:right-1"},null,-1)),tt=Q({__name:"PlayerEpisode",props:{selectedEpisode:null,data:null},emits:["selected"],setup(l,{emit:x}){const e=l,{t:c}=Y(),w=F(()=>{const r={};for(const m of e.data)m.season&&(r[m.season.toString()]||(r[m.season.toString()]=[]),r[m.season.toString()].push(m));return r}),s=F(()=>Object.keys(w.value).map(r=>({value:r,title:`${c("season")} ${r}`}))),i=A("ALL");return(r,m)=>{const d=He;return b(),P("div",Ve,[u("div",Me,[L(d,{title:r.$t("season"),list:S(s),searchable:"","has-default-all":"",style:{foreground:"bg-bg-11"},onOnChange:m[0]||(m[0]=y=>i.value=y[0])},null,8,["title","list"])]),u("div",Ue,[(b(!0),P(W,null,G(S(i)!="ALL"?{[S(i)]:S(w)[S(i)]}:S(w),(y,T)=>(b(),P("section",{key:T,"aria-label":"item",class:"flex w-full flex-col gap-8 text-base"},[u("header",ze,[u("div",We,[u("h6",Ge,B(r.$t("season")),1),u("span",Qe,[ve(B(T)+" ",1),Ke])])]),u("ul",Xe,[(b(!0),P(W,null,G(y,n=>(b(),P("li",{key:n.file_id,class:H(["bg-bg-11 hover:bg-bg-10 group relative flex min-w-[12em] !cursor-pointer justify-center rounded-xl py-3 opacity-90 transition-colors hover:opacity-100 ltr:rounded-l-none rtl:rounded-r-none",{"!bg-bg-9 selected-episode !cursor-default !opacity-100":n.file_id===l.selectedEpisode}]),onClick:C=>x("selected",n.file_id)},[(b(),P("svg",{class:H(["fill-bg-11 group-hover:fill-bg-10 absolute top-0 h-full rounded-r-xl transition-colors ltr:right-full ltr:translate-x-[1px] ltr:rotate-180 rtl:left-full rtl:translate-x-[-1px]",{"!fill-bg-9 ":n.file_id===l.selectedEpisode}]),viewBox:"0 0 8 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Je,2)),et,u("p",{class:H(["opacity-80",{"!opacity-100":n.file_id===l.selectedEpisode}])},B(r.$t("episode"))+" "+B(n.episode_number),3)],10,Ze))),128))])]))),128))])])}}}),lt=ee(tt,[["__scopeId","data-v-4ce07527"]]),st=l=>(le("data-v-110db96c"),l=l(),se(),l),ot={key:0,title:"",class:"child-item auto-dir bg-bg-13/50 border-bg-1/10 absolute bottom-full right-4 z-20 mb-7 flex h-[12em] w-[28em] cursor-default rounded-xl border-2 p-4 backdrop-blur-lg"},nt={class:"flex flex-col flex-nowrap gap-8 overflow-y-auto px-2"},at=["aria-label"],it={class:"flex w-full flex-row flex-nowrap items-center gap-2"},rt={class:"!text-fonts-200 whitespace-nowrap font-semibold"},ut=st(()=>u("span",{class:"bg-bg-10 h-1 w-full rounded-full"},null,-1)),ct={class:"flex flex-row flex-wrap items-center gap-4 !text-xs"},dt=["onClick"],pt=Q({__name:"PlayerSubtitle",props:{playerData:null},setup(l){const x=l,{t:e}=Y(),c=F(()=>[{title:e("subtitle.subtitle"),lable:"subtitle",selectedOption:w.value,select:o=>w.value=o,options:[{title:e("subtitle.persian"),value:"fa"},{title:e("subtitle.english"),value:"en"},{title:e("subtitle.persianAndEnglish"),value:"fa+en"},{title:e("subtitle.withoutSubtitle"),value:"none"}].filter(o=>{var f,h,_,E;return o.value==="fa+en"?((f=x.playerData.subtitle)==null?void 0:f.fa)&&((h=x.playerData.subtitle)==null?void 0:h.en):o.value==="fa"?(_=x.playerData.subtitle)==null?void 0:_.fa:o.value==="en"?(E=x.playerData.subtitle)==null?void 0:E.en:!0})},{title:e("subtitle.subtitleSize"),lable:"subtitle size",selectedOption:s.value,select:o=>s.value=o,options:[{title:e("subtitle.small"),value:"0.5"},{title:e("subtitle.medium"),value:"0.75"},{title:e("subtitle.huge"),value:"1.25"},{title:e("subtitle.veryHuge"),value:"1.50"}]},{title:e("subtitle.subtitleColor"),lable:"subtitle text color",selectedOption:i.value,select:o=>i.value=o,options:[{title:e("subtitle.yellow"),value:"#FF0"},{title:e("subtitle.white"),value:"#FFF"},{title:e("subtitle.cyan"),value:"#0FF"},{title:e("subtitle.purple"),value:"#F0F"}]},{title:e("subtitle.subtitleBackground"),lable:"subtitle background color",selectedOption:r.value,select:o=>r.value=o,options:[{title:e("subtitle.transparent"),value:"0"},{title:e("subtitle.acrylic"),value:"acrylic"},{title:e("subtitle.dimedBlack"),value:"0.5"},{title:e("subtitle.black"),value:"1"}]}]),w=q("preferredLanguage","fa"),s=q("preferredSize","0.75"),i=q("preferredColor","#FFF"),r=q("preferredBackground","acrylic"),m=".vjs-subtitle",d=A(!1),y=document.querySelector(m),T=document.querySelector(m+" .clickable-btn"),n=z.getAllPlayers()[0];ie(T,"click",()=>d.value=!d.value),re(y,()=>d.value=!1),te(()=>{C(),g(),O(),k(),$()});function C(){var o,f;(o=x.playerData.subtitle)!=null&&o.fa&&n.addRemoteTextTrack({kind:"subtitles",label:"فارسی",language:"fa",id:"track1",src:x.playerData.subtitle.fa,default:!0,mode:"showing"},!0),(f=x.playerData.subtitle)!=null&&f.en&&n.addRemoteTextTrack({kind:"subtitles",label:"انگلیسی",language:"en",id:"track2",src:x.playerData.subtitle.en,default:!1,mode:"showing"},!0)}function g(){try{const o=n.textTracks(),f=Array.from(o).filter(h=>h.label!=="segment-metadata");for(const h of f){const _=h.language===w.value||w.value==="fa+en";h.mode=_?"showing":"hidden"}n.textTrackSettings.updateDisplay()}catch(o){console.error("updateLanguage",o)}}function O(){try{n.textTrackSettings.setValues({color:i.value}),n.textTrackSettings.updateDisplay()}catch(o){console.error("updateLanguage",o)}}function k(){try{n.textTrackSettings.setValues({fontPercent:Number(s.value)}),n.textTrackSettings.updateDisplay()}catch(o){console.error("updateLanguage",o)}}function $(){var o,f;try{r.value!=="acrylic"?((o=document.querySelector(".vjs-text-track-display"))==null||o.classList.remove("acrylic"),n.textTrackSettings.setValues({backgroundOpacity:r.value})):((f=document.querySelector(".vjs-text-track-display"))==null||f.classList.add("acrylic"),n.textTrackSettings.setValues({backgroundOpacity:"0"})),n.textTrackSettings.updateDisplay()}catch(h){console.error("updateLanguage",h)}}return j(w,()=>g()),j(i,()=>O()),j(s,()=>k()),j(r,()=>$()),(o,f)=>(b(),X(oe,{to:m},[L(ue,{name:"player-options"},{default:Z(()=>[S(d)?(b(),P("div",ot,[u("div",nt,[(b(!0),P(W,null,G(S(c),h=>(b(),P("section",{key:h.lable,"aria-label":h.lable,class:"flex w-full flex-col gap-8 text-base"},[u("header",it,[u("h6",rt,B(h.title),1),ut]),u("ul",ct,[(b(!0),P(W,null,G(h.options,_=>(b(),P("li",{key:_.title,class:H(["bg-bg-11/50 hover:bg-bg-11 flex min-w-[9em] !cursor-pointer justify-center rounded-xl p-2 transition-colors",{"!bg-primary-500 !hover:bg-bg-primary-500 !cursor-default":h.selectedOption===_.value}]),onClick:E=>h.select(_.value)},B(_.title),11,dt))),128))])],8,at))),128))])])):V("",!0)]),_:1})]))}}),ft=ee(pt,[["__scopeId","data-v-110db96c"]]),vt=l=>(le("data-v-d332e047"),l=l(),se(),l),yt={key:0,title:"",class:"child-item auto-dir bg-bg-13/50 border-bg-1/10 absolute bottom-full right-4 z-20 mb-7 flex h-[12em] w-[28em] cursor-default rounded-xl border-2 p-4 backdrop-blur-lg"},mt={class:"flex flex-col flex-nowrap gap-8 overflow-y-auto px-2"},_t=["aria-label"],bt={class:"flex w-full flex-row flex-nowrap items-center gap-2"},gt={class:"!text-fonts-200 whitespace-nowrap font-semibold"},ht=vt(()=>u("span",{class:"bg-bg-10 h-1 w-full rounded-full"},null,-1)),xt={class:"flex flex-row flex-wrap items-center gap-4 !text-xs"},wt=["onClick"],kt=Q({__name:"PlayerSettings",emits:["reloadPlayer"],setup(l,{emit:x}){const{t:e}=Y(),c=F(()=>[{title:e("playerSettings.audioChannels"),lable:"Audio channel",selectedOption:w.value,select:g=>w.value=g,options:[{title:e("playerSettings.auto"),value:"default"},{title:e("playerSettings.6Channels"),value:"2ch"},{title:e("playerSettings.2Channels"),value:"6ch"}]},{title:e("playerSettings.playbackSpeed"),lable:"Playback speed",selectedOption:s.value,select:g=>s.value=g,options:[{title:"0.5",value:"0.5"},{title:e("playerSettings.normal"),value:"1"},{title:"1.5",value:"1.5"},{title:"2",value:"2"}]},{title:e("playerSettings.bufferTime"),lable:"Buffer time",selectedOption:i.value,select:g=>i.value=g,options:[{title:`1 ${e("playerSettings.minutes")}`,value:"60"},{title:`2.5 ${e("playerSettings.minutes",{Pluralization:"s"})}`,value:"150"},{title:`5 ${e("playerSettings.minutes",{Pluralization:"s"})}`,value:"300"}]}]),w=q("preferredAudioChannel","default"),s=q("preferredPlaybackSpeed","1"),i=q("preferredbufferTime","60"),r=".vjs-settings",m=A(!1),d=document.querySelector(r),y=document.querySelector(r+" .clickable-btn");ie(y,"click",()=>m.value=!m.value),re(d,()=>m.value=!1);const T=z.getAllPlayers()[0];te(()=>{n(),C()});function n(){try{T.playbackRate(Number(s.value))}catch(g){console.error("updatePlaybackSpeed",g)}}async function C(){try{for(;!T.tech({IWillNotUseThisInPlugins:!0}).vhs;)await new Promise(g=>setTimeout(g,100));T.tech({IWillNotUseThisInPlugins:!0}).vhs.options_.externVhs.MAX_GOAL_BUFFER_LENGTH=parseInt(i.value),T.tech({IWillNotUseThisInPlugins:!0}).vhs.options_.externVhs.GOAL_BUFFER_LENGTH=parseInt(i.value)}catch(g){console.error("updateBufferTime",g)}}return j(w,()=>setTimeout(()=>x("reloadPlayer"),100)),j(s,()=>n()),j(i,()=>C()),(g,O)=>(b(),X(oe,{to:r},[L(ue,{name:"player-options"},{default:Z(()=>[S(m)?(b(),P("div",yt,[u("div",mt,[(b(!0),P(W,null,G(S(c),k=>(b(),P("section",{key:k.lable,"aria-label":k.lable,class:"flex w-full flex-col gap-8 text-base"},[u("header",bt,[u("h6",gt,B(k.title),1),ht]),u("ul",xt,[(b(!0),P(W,null,G(k.options,$=>(b(),P("li",{key:$.title,class:H(["local-numbers bg-bg-11/50 hover:bg-bg-11 flex min-w-[9em] !cursor-pointer justify-center rounded-xl p-2 transition-colors",{"!bg-primary-500 !hover:bg-bg-primary-500 !cursor-default":k.selectedOption===$.value}]),onClick:o=>k.select($.value)},B($.title),11,wt))),128))])],8,_t))),128))])])):V("",!0)]),_:1})]))}}),St=ee(kt,[["__scopeId","data-v-d332e047"]]),pe=l=>(le("data-v-9f0679b3"),l=l(),se(),l),Tt={class:"absolute bottom-24 right-4 flex flex-col gap-2"},Pt=pe(()=>u("span",{class:"shadow"},null,-1)),$t={class:"content"},Et=pe(()=>u("span",{class:"shadow"},null,-1)),Ct={class:"content"},Lt=pe(()=>u("span",{class:"shadow"},null,-1)),It={class:"content"},Dt={class:"content"},At=Q({__name:"PlayerSideActions",props:{options:null},emits:["play-next-episode"],setup(l,{emit:x}){const e=l,c=z.getAllPlayers()[0],w=F(()=>{if(e.options.intro_start)return n(e.options.intro_start)}),s=F(()=>{if(e.options.intro_end)return n(e.options.intro_end)}),i=F(()=>{if(e.options.previously_start)return n(e.options.previously_start)}),r=F(()=>{if(e.options.previously_end)return n(e.options.previously_end)}),m=F(()=>{if(e.options.end)return n(e.options.end)}),d=A({visible:!1,progress:0}),y=A({visible:!1,progress:0}),T=A({visible:!1,progress:0});te(()=>c.on("timeupdate",be(()=>C(Math.floor(c.currentTime())),1e3)));function n(f){const[h,_,E]=f.split(":");return parseInt(h)*3600+parseInt(_)*60+parseInt(E)}function C(f){typeof w.value=="number"&&typeof s.value=="number"&&(f>=w.value&&f<=s.value?(d.value.visible=!0,d.value.progress=(f-w.value)/(s.value-w.value)):d.value.visible=!1),typeof i.value=="number"&&typeof r.value=="number"&&(f>=i.value&&f<=r.value?(y.value.visible=!0,y.value.progress=(f-i.value)/(r.value-i.value)):y.value.visible=!1),typeof m.value=="number"&&(f>=m.value?O():T.value.visible=!1)}const g=A({token:e.options.token,cancelled:!1,busy:!1});async function O(){if(g.value.busy||g.value.cancelled)return;T.value.visible=!0,g.value.busy=!0;const f=()=>{g.value.cancelled=!0,T.value.progress=0,g.value.busy=!1};for(let h=0;h<50;h++){if(g.value.cancelled||(await J.core.delay(100),c.paused()))return f();T.value.progress=h/50}if(g.value.cancelled)return f();await J.core.delay(1100),x("play-next-episode")}function k(){typeof s.value=="number"&&c.currentTime(s.value)}function $(){typeof r.value=="number"&&c.currentTime(r.value)}function o(){typeof m.value=="number"&&x("play-next-episode")}return(f,h)=>{const _=ye;return b(),X(oe,{to:"#player"},[u("div",Tt,[L(ge,{name:"actions",appear:""},{default:Z(()=>[S(d).visible?(b(),P("span",{key:"intro",class:"action",onClick:k},[u("span",{class:"bar",style:ae(`transform: scaleX(${S(d).progress})`)},null,4),Pt,u("div",$t,[L(_,{name:"ph:arrow-clockwise-bold"}),u("p",null,B(f.$t("skipIntro")),1)])])):V("",!0),S(y).visible?(b(),P("span",{key:"previous",class:"action",onClick:$},[u("span",{class:"bar",style:ae(`transform: scaleX(${S(y).progress})`)},null,4),Et,u("div",Ct,[L(_,{name:"ph:arrow-clockwise-bold"}),u("p",null,B(f.$t("skipPreviously")),1)])])):V("",!0),S(T).visible?(b(),P("span",{key:"next-episode",class:"action",onClick:o,onMouseenter:h[0]||(h[0]=E=>S(g).cancelled=!0)},[u("span",{class:H(["bar",{"!hidden":S(g).cancelled===!0}]),style:ae(`transform: scaleX(${S(T).progress})`)},null,6),Lt,u("div",It,[L(_,{name:"ph:skip-forward-bold"}),u("p",Dt,B(f.$t("nextEpisode")),1)])],32)):V("",!0)]),_:1})])])}}}),Bt=ee(At,[["__scopeId","data-v-9f0679b3"]]),Ot={key:0,title:"",class:"child-item auto-dir bg-bg-13/50 border-bg-1/10 absolute bottom-full right-4 z-20 mb-7 flex min-h-[12em] w-[10em] cursor-default rounded-xl border-2 py-4 backdrop-blur-lg"},Ft={class:"felx w-full flex-col flex-nowrap gap-8 overflow-y-auto"},Nt={class:"flex w-full flex-col gap-4 text-base"},Rt={class:"flex flex-col gap-2"},qt=["onClick"],jt={class:"relative"},Ht=Q({__name:"PlayerQuality",props:{playerData:null},emits:["reloadPlayer"],setup(l){const x=l,{t:e}=Y(),c=z.getAllPlayers()[0],w=q("preferredAudioChannel","default"),s=q("preferredQuality","AUTO"),i=A(0),r=F(()=>x.playerData.file.m3u8.map(k=>{const $=k.label.replace("خودکار","AUTO");return{label:$,src:k[w.value],selected:$===s.value,height:Number(k.label.replace("p",""))}}));me(()=>{var o;const k=((o=r.value.find(f=>f.selected))==null?void 0:o.label)||"AUTO",$=document.querySelector(".selected-quality-label");k==="AUTO"?$.innerHTML=e("auto"):$.innerHTML=""});let m="";m&&clearInterval(m),m=setInterval(()=>{var $,o,f,h;const k=(f=(o=($=(c==null?void 0:c.tech({IWillNotUseThisInPlugins:!0})).vhs)==null?void 0:$.selectPlaylist)==null?void 0:o.call($))==null?void 0:f.attributes.RESOLUTION.height;i.value=k||((h=r.value.find(_=>_.selected))==null?void 0:h.height)||r.value[1].height},2e3),ce(()=>{m&&clearInterval(m)});function d(k){if(T.value=!1,k.selected||!c)return;s.value=k.label;const $=c.paused(),o=c.currentTime(),f=c.playbackRate();c.src(k.src),c.ready(()=>{$||c.play(),c.playbackRate(f),c.currentTime(o)})}const y=".vjs-quality-selector",T=A(!1),n=document.querySelector(y),C=document.querySelector(y+" .clickable-btn");ie(C,"click",()=>T.value=!T.value),re(n,()=>T.value=!1);const g=document.querySelector(".quality-display");s.value&&s.value!=="AUTO"&&(g.innerHTML=s.value),j(i,()=>g.innerHTML=i.value+"p");const O=r.value.find(k=>k.selected);return c.src((O==null?void 0:O.src)||r.value[0].src),(k,$)=>(b(),X(oe,{to:y},[L(ue,{name:"player-options"},{default:Z(()=>[S(T)?(b(),P("div",Ot,[u("div",Ft,[u("section",Nt,[u("ul",Rt,[(b(!0),P(W,null,G(S(r),o=>(b(),P("li",{key:o.label,class:H(["hover:bg-bg-1/10 hover:!text-fonts-50 !text-fonts-200 relative flex w-full min-w-[9em] cursor-pointer items-center justify-center gap-2 p-3 transition-colors",{"!bg-bg-1/10 !hover:bg-bg-1/20 !text-fonts-50 !cursor-default":o.selected}]),onClick:f=>d(o)},[u("span",{class:H(["bg-primary-500 shadow-primary-500 absolute left-2 top-1/2 h-1/2 w-[2px] -translate-y-1/2 rounded-full opacity-0 shadow-[0_0_8px_1px]",{"!opacity-100":o.selected}])},null,2),u("div",jt,B(o.label.replace("AUTO",k.$t("auto"))),1)],10,qt))),128))])])])])):V("",!0)]),_:1})]))}}),Vt=ee(Ht,[["__scopeId","data-v-f6f184c0"]]),Mt=l=>{l.on("error",async function(x){x.stopImmediatePropagation();const e=this.player().error(),c=(s,i)=>{switch(s){case 200:return"لطفا صبر کنید...";case 404:return"فایل پیدا نشد";case 403:return i.includes("Disable VPN")?"وی پی ان خود را خاموش کنید":i.includes("Not Allowed")?"اشتراک شما به پایان رسیده":i.includes("Banned Account")?"حساب شما مسدود شده":i.includes("Banned IP")?"آی پی شما مسدود شده":"شما مجاز به تماشای این عنوان نیستید";case 406:return"شما بیش از سقف مجاز اشتراک خود تماشا کردید";case 503:return"تماشای این عنوان موقتا غیر فعال شده";case 400:return"درخواست غیر مجاز";default:return"ارور: "+s}},w=s=>{const i=document.querySelector(".vjs-modal-dialog-content");i.innerHTML=s};if(e.code===4){w("");try{const s=await he(l.currentSrc()),i=c(0,s.data);if(w(i),console.warn({exactError:i}),s.status===200){window.location.reload();return}}catch(s){console.log(s.response);const i=c(s.response.status,s.response.data);w(i),console.warn({exactError:i})}}})},Ut=[Ae,Be,Oe,Fe,Ne,Re,qe],zt=(l,x,{playerData:e,$emit:c,t:w})=>{let s=[];s=Ut;for(const i of s){const r=i({player:l,playerData:e,$emit:c,t:w});r&&(x.registerComponent(r.config.name,r.button),l.getChild("controlBar").addChild(r.config.name,{},r.config.index))}},Wt=l=>{window.addEventListener("keydown",e);const x=document.querySelector(".vjs-volume-panel");x&&x.addEventListener("wheel",c);function e(s){s.key==="Tab"&&s.preventDefault(),s.key===" "&&(s.preventDefault(),l.paused()?l.play():l.pause()),s.key==="k"&&(s.preventDefault(),l.paused()?l.play():l.pause()),s.key==="Enter"&&(document.fullscreenElement?l.exitFullscreen():l.requestFullscreen()),s.key==="f"&&(document.fullscreenElement?l.exitFullscreen():l.requestFullscreen()),s.key==="m"&&(l.muted()?l.muted(!1):l.muted(!0)),s.key==="ArrowRight"&&l.currentTime(l.currentTime()+5),s.key==="ArrowLeft"&&l.currentTime(l.currentTime()-5),s.key==="ArrowUp"&&(s.preventDefault(),l.volume(l.volume()+.05)),s.key==="ArrowDown"&&(s.preventDefault(),l.volume(l.volume()-.05))}function c(s){return Math.sign(s.deltaY)<0?l.volume(l.volume()+.05):l.volume(l.volume()-.05),s.preventDefault(),!1}return()=>{window&&window.removeEventListener("keydown",e),x&&x.removeEventListener("wheel",c)}},Gt={class:"h-full w-full"},Qt=["poster"],Kt={key:0},Xt=Q({__name:"PlayerMain",props:{playerData:null,overlayPlayer:{type:Boolean}},emits:["onVideoEnded","onProgress","onPlay","onPause","onSeek","onPlayerReady","reloadPlayer","playNextEpisode"],setup(l,{expose:x,emit:e}){const c=l,w=_e(),{locale:s,t:i}=Y(),r=F(()=>c.playerData.image.cover_webp||c.playerData.image.cover),m=A(!1);let d,y;function T(){d&&(console.log("30nama Player v5.0.0"),n(),C(),o(),c.playerData.info.time&&d.currentTime(c.playerData.info.time),m.value=!0,e("onPlayerReady"))}te(()=>{var N;z.log.level(((N=w.user)!=null&&N.is_admin,"off"));const _={...je},E=!!c.playerData.file.m3u8[0].default;_.html5.vhs.experimentalBufferBasedABR=E,_.language=s.value,d=z("player",_,T),d.on("ended",()=>e("onVideoEnded")),d.on("play",()=>e("onPlay")),d.on("pause",()=>e("onPause")),d.on("seeking",R=>e("onSeek",R.target.player.currentTime())),d.on("timeupdate",()=>e("onProgress",d.currentTime(),d)),y=Wt(d),Mt(d),zt(d,z,{playerData:c.playerData,$emit:e,t:i})}),ce(()=>{y&&y(),d&&d.dispose()});function n(){document.querySelectorAll(".vjs-time-control").forEach(E=>{E.addEventListener("click",()=>{const N=document.querySelector(".vjs-remaining-time");if(!N)return;const R=document.querySelector(".vjs-remaining-time"),K=document.querySelector(".vjs-current-time"),M=document.querySelector(".vjs-time-divider"),p=document.querySelector(".vjs-duration");N.style.display===""||N.style.display==="none"?(R.style.display="block",K.style.display="none",M.style.display="none",p.style.display="none"):(R.style.display="none",K.style.display="block",M.style.display="block",p.style.display="block")})})}function C(){const _=d.el().appendChild(document.createElement("div"));_.className="video-title",_.innerHTML=c.playerData.info.title}function g(){d.play()}function O(){d.pause()}function k(_){d.currentTime(_)}function $(){var _;(_=document.getElementById("player"))==null||_.scrollIntoView({behavior:"smooth"})}function o(){const _=document.getElementById("player");_&&_.addEventListener("click",()=>_.focus())}function f(){return d.isFullscreen_}function h(){d.requestFullscreen()}return x({play:g,pause:O,seek:k,scrollToView:$,isFullscreen:f,fullscreen:h}),(_,E)=>{const N=ft,R=St,K=Bt,M=Vt;return b(),P("div",Gt,[u("video",{id:"player",class:"video-js h-full w-full",poster:S(r),playsinline:""},null,8,Qt),S(m)?(b(),P("span",Kt,[L(N,{"player-data":l.playerData},null,8,["player-data"]),L(R,{onReloadPlayer:E[0]||(E[0]=p=>e("reloadPlayer"))}),L(K,{options:l.playerData.options,onPlayNextEpisode:E[1]||(E[1]=p=>e("playNextEpisode"))},null,8,["options"]),L(M,{"player-data":l.playerData,onReloadPlayer:E[2]||(E[2]=p=>e("reloadPlayer"))},null,8,["player-data"])])):V("",!0)])}}}),Zt={class:"relative flex h-full w-full items-center justify-center"},Yt={key:0,class:"flex w-full flex-col items-center justify-center gap-4"},Jt={key:1,class:"absolute flex flex-col items-center gap-2 text-2xl"},el=u("span",{class:"cover-2 bg-bg-12 absolute inset-0 z-40 opacity-0"},null,-1),tl={key:2,class:"h-full w-full"},bl=Q({__name:"[id]",setup(l){const x=_e(),e=A(!1),c=xe(),w=we(),s=ke(),{t:i}=Y(),r=Se(),m=Te(),d=F(()=>s.params.id),y=A(),T=A(!0),n=A(),C=A();let g=!1,O;Pe({title:()=>{var p,t,a;return`${i("seo.30nama")} | ${(p=y.value)!=null&&p.result.info.title?((t=y.value)==null?void 0:t.result.info.title.local)??((a=y.value)==null?void 0:a.result.info.title.english):""}`}});function k(p){var a;const t=(a=y.value)==null?void 0:a.result;if(t!=null&&t.continue_watching)if(p){let v=t.hls.find(I=>{var D;return I.info.file_id===((D=t.continue_watching)==null?void 0:D.file_id)});return v||(v=t.hls[0]),{image:{cover:t.image.cover.jpg,cover_webp:t.image.cover.webp},info:{displayName:v.info.episode_name||t.info.title.local||t.info.title.english,title:v.info.episode_name||t.info.title.local||t.info.title.english,file_id:v.info.file_id,post_id:t.info.post_id,isSeries:p,time:t.continue_watching.time},options:{intro_end:v.options.intro_end,intro_start:v.options.intro_start,previously_start:v.options.previously_start,previously_end:v.options.previously_end,end:v.options.end,token:v.options.token},subtitle:{...v.file.subtitle},file:{m3u8:v.file.m3u8}}}else{const v=t.hls[0];return{image:{cover:t.image.cover.jpg,cover_webp:t.image.cover.webp},info:{displayName:t.info.title.local||t.info.title.english,title:t.info.title.local||t.info.title.english,file_id:v.info.file_id,post_id:t.info.post_id,isSeries:p,time:t.continue_watching.time},options:{intro_end:v.options.intro_end,intro_start:v.options.intro_start,previously_start:v.options.previously_start,previously_end:v.options.previously_end,end:v.options.end,token:v.options.token},subtitle:{...v.file.subtitle},file:{m3u8:v.file.m3u8}}}}function $(p){var v;const t=(v=y.value)==null?void 0:v.result;if(!t)return;const a=t.hls[0];return{image:{cover:t.image.cover.jpg,cover_webp:t.image.cover.webp},info:{displayName:t.info.title.local||t.info.title.english,title:t.info.title.local||t.info.title.english,file_id:a.info.file_id,post_id:t.info.post_id,isSeries:p,time:0},options:{intro_end:a.options.intro_end,intro_start:a.options.intro_start,previously_start:a.options.previously_start,previously_end:a.options.previously_end,end:a.options.end,token:a.options.token},subtitle:{...a.file.subtitle},file:{m3u8:a.file.m3u8}}}function o(p){var v,I;const t=(v=y.value)==null?void 0:v.result;if(!t)return;const a=t.hls.find(D=>D.info.file_id===p);a&&((I=C.value)==null||I.scrollToView(),n.value={image:{cover:t.image.cover.jpg,cover_webp:t.image.cover.webp},info:{displayName:t.info.title.local||t.info.title.english,title:t.info.title.local||t.info.title.english,file_id:a.info.file_id,post_id:t.info.post_id,isSeries:!0,time:0},options:{intro_end:a.options.intro_end,intro_start:a.options.intro_start,previously_start:a.options.previously_start,previously_end:a.options.previously_end,end:a.options.end,token:a.options.token},subtitle:{...a.file.subtitle},file:{m3u8:a.file.m3u8}},Ce(()=>{var D,U;(D=C.value)==null||D.play(),(U=C.value)==null||U.seek(0)}))}function f(p,t){var D;if(t.paused()||!n.value||!t)return;const a=n.value.info.file_id,v=n.value.info.post_id,I=(D=n.value)==null?void 0:D.options.token;K(v,a,Math.floor(p),Math.floor(t.duration()),I)}function h(){var I,D,U;const p=(I=n.value)==null?void 0:I.info.file_id,t=(D=y.value)==null?void 0:D.result;if(!t)return;const a=t.hls.find(ne=>ne.info.file_id===p);if(!a)return;const v=t.hls[t.hls.indexOf(a)+1];v&&(g=(U=C.value)==null?void 0:U.isFullscreen(),o(v.info.file_id))}function _(){var p;g&&((p=C.value)==null||p.fullscreen())}async function E(){T.value=!0,await J.core.delay(750),T.value=!1}let N=!1,R=0;function K(p,t,a,v,I){N||a===R||a%30===0&&a>0&&(R=a,N=!0,J.API.actions.observer(p,t,x.user.user_id,a,v,I),N=!1)}te(async()=>{var a,v,I;const p=s.query.free==="true";if(!p&&!x.user){c.ignoreNextRoute(),w.push("/auth/login");return}if(!p&&!((a=x.user)!=null&&a.user_allowed_to_stream)){T.value=!1;return}if(e.value=!0,y.value=await $e("STREAM::"+d.value,()=>J.API.actions.stream(Number(d.value),p)),T.value=!1,(v=y.value)!=null&&v.error&&r(y.value.msg,"ERROR"),!((I=y.value)!=null&&I.result))return;y.value.result.image.cover.webp&&fe(y.value.result.image.cover.webp);const t=y.value.result.hls.length>1;y.value.result.continue_watching?n.value=k(t):n.value=$(t),Ee("lastWatchedTitle").value=Number(d.value)}),ce(()=>{var p;fe(""),(p=m.setDefaultStatus)==null||p.call(m),clearInterval(O)}),me(()=>{var p,t,a;n.value&&((p=y.value)!=null&&p.result.info.title.english)&&((a=m.setWatchingStatus)==null||a.call(m,(t=y.value)==null?void 0:t.result.info.title.english))});const M=F(()=>{var p;return(p=y.value)==null?void 0:p.result.hls.map(t=>t.info)});return(p,t)=>{const a=ye,v=Le,I=De,D=Ie,U=Xt,ne=lt;return b(),P("div",Zt,[S(e)?S(T)||!S(n)?(b(),P("div",Jt,[el,u("span",null,[L(D,{class:"flex",type:"triangle"})]),u("p",null,B(p.$t("loading")),1)])):(b(),P("div",tl,[(b(),X(U,{key:S(n).info.file_id,ref_key:"player",ref:C,"player-data":S(n),onOnProgress:f,onReloadPlayer:E,onPlayNextEpisode:h,onOnVideoEnded:h,onOnPlayerReady:_},null,8,["player-data"])),S(n).info.isSeries&&S(M)?(b(),X(ne,{key:0,data:S(M),"selected-episode":Number(S(n).info.file_id),onSelected:o},null,8,["data","selected-episode"])):V("",!0)])):(b(),P("div",Yt,[L(a,{name:"ph:warning-fill",class:"text-bg-10 text-[7em]"}),u("h4",null,B(p.$t("notAllowedToWatchStream")),1),L(I,{to:"https://30nama.com/pricing",external:"",target:"_blank",class:"min-w-[12em]"},{default:Z(()=>[L(v,{class:"btn-primary-outline w-full text-sm"},{default:Z(()=>[L(a,{name:"ph:shopping-cart-fill"}),ve(" "+B(p.$t("pricing.buyNow")),1)]),_:1})]),_:1})]))])}}});export{bl as default};
